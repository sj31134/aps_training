# APS μ½”λ“ λ¦¬λ·° λ³΄κ³ μ„

## λ¦¬λ·° μΌμ
2024λ…„ (ν„μ¬)

## λ¦¬λ·° λ²”μ„
- Project6: ACC Hub Browser
- APS Data Management API ν†µν•©
- 2-Legged OAuth (2LO) μΈμ¦

---

## π”΄ Critical Issues (μ¦‰μ‹ μμ • ν•„μ”)

### 1. API μ—”λ“ν¬μΈνΈ λ¶μΌμΉ
**μ„μΉ**: `routes/aps.js`, `server/config.js`

**λ¬Έμ **:
- Top Folders μ—”λ“ν¬μΈνΈκ°€ μλ»λμ—μ„ μ μμ
- APS κ³µμ‹ λ¬Έμ„μ— λ”°λ¥΄λ©΄ Top Foldersλ” `/data/v1/projects/{projectId}/topFolders`λ¥Ό μ‚¬μ©ν•΄μ•Ό ν•¨
- ν„μ¬: `/project/v1/hubs/{hubId}/projects/{projectId}/folders`
- κ¶μ¥: `/data/v1/projects/{projectId}/topFolders` (hubId λ¶ν•„μ”)

**μν–¥**: Top Folders μ΅°ν μ‹¤ν¨ κ°€λ¥μ„±

### 2. JSON:API μ‘λ‹µ κµ¬μ΅° λ―Έμ²λ¦¬
**μ„μΉ**: `routes/aps.js` (λ¨λ“  μ—”λ“ν¬μΈνΈ)

**λ¬Έμ **:
- APS Data Management APIλ” JSON:API μ¤ν™μ„ λ”°λ¦„
- μ‘λ‹µ κµ¬μ΅°: `{ data: [...], included: [...], links: {...} }`
- ν„μ¬ μ½”λ“λ” `response.data.data`λ§ μ‚¬μ©ν•κ³  `included` λ°°μ—΄ λ¬΄μ‹
- Relationships λ°μ΄ν„°λ” `included` λ°°μ—΄μ— μμ„ μ μμ

**μν–¥**: ν΄λ” λ‚΄μ© μ΅°ν μ‹ μΌλ¶€ λ°μ΄ν„° λ„λ½ κ°€λ¥

### 3. ν΄λ” λ‚΄μ© μ΅°ν μ—”λ“ν¬μΈνΈ λ¶ν™•μ‹¤
**μ„μΉ**: `server/config.js` line 34

**λ¬Έμ **:
- ν„μ¬: `/data/v1/projects/{projectId}/folders/{folderId}/relationships/contents`
- APS κ³µμ‹ λ¬Έμ„ ν™•μΈ ν•„μ”
- λ€μ•: `/data/v1/projects/{projectId}/folders/{folderId}/contents` (relationships μ—†μ΄)

**μν–¥**: 404 μ—λ¬ λ°μƒ κ°€λ¥

---

## π΅ Major Issues (μ¤‘μ” κ°μ„  ν•„μ”)

### 4. λ―Έμ‚¬μ© Import
**μ„μΉ**: `routes/aps.js` line 8

**λ¬Έμ **:
```javascript
import jwt from 'jsonwebtoken';  // μ‚¬μ©λμ§€ μ•μ
```

**μν–¥**: λ¶ν•„μ”ν• μμ΅΄μ„±, λ²λ“¤ ν¬κΈ° μ¦κ°€

### 5. ν† ν° μΊμ‹± λ™μ‹μ„± λ¬Έμ 
**μ„μΉ**: `routes/aps.js` `getAccessToken()` ν•¨μ

**λ¬Έμ **:
- μ—¬λ¬ μ”μ²­μ΄ λ™μ‹μ— ν† ν° λ§λ£λ¥Ό κ°μ§€ν•λ©΄ μ—¬λ¬ κ°μ ν† ν° μ”μ²­μ΄ λ°μƒν•  μ μμ
- Race condition κ°€λ¥μ„±

**κ¶μ¥ ν•΄κ²°μ±…**:
```javascript
let tokenPromise = null;  // μ§„ν–‰ μ¤‘μΈ ν† ν° μ”μ²­ μ¶”μ 
```

### 6. μ—λ¬ μ‘λ‹µ κµ¬μ΅° λ¶μΌμΉ
**μ„μΉ**: `routes/aps.js` (λ¨λ“  λΌμ°νΈ)

**λ¬Έμ **:
- μΌλ¶€ μ—λ¬λ” `details` ν•„λ“λ¥Ό ν¬ν•¨ν•κ³ , μΌλ¶€λ” ν¬ν•¨ν•μ§€ μ•μ
- μΌκ΄€μ„± μ—†λ” μ—λ¬ μ‘λ‹µ κµ¬μ΅°

**κ¶μ¥**: ν‘μ¤€ν™”λ μ—λ¬ μ‘λ‹µ ν•μ‹ μ‚¬μ©

### 7. API μ‘λ‹µ κ²€μ¦ λ¶€μ΅±
**μ„μΉ**: `routes/aps.js`, `public/app.js`

**λ¬Έμ **:
- API μ‘λ‹µμ΄ μμƒν• κµ¬μ΅°μΈμ§€ κ²€μ¦ν•μ§€ μ•μ
- `response.data.data`κ°€ undefinedμΌ κ²½μ° μ²λ¦¬ μ—†μ

**μν–¥**: λ°νƒ€μ„ μ—λ¬ κ°€λ¥μ„±

---

## πΆ Minor Issues (κ°μ„  κ¶μ¥)

### 8. λ΅κΉ… κ°μ„ 
**μ„μΉ**: `server/config.js`

**κ¶μ¥**:
- κµ¬μ΅°ν™”λ λ΅κΉ… (JSON ν•μ‹)
- λ΅κ·Έ λ λ²¨λ³„ ν•„ν„°λ§
- ν”„λ΅λ•μ… ν™κ²½ λ΅κΉ… μ„¤μ •

### 9. νƒ€μ… μ•μ „μ„±
**μ„μΉ**: μ „μ²΄ μ½”λ“λ² μ΄μ¤

**κ¶μ¥**:
- TypeScript λ„μ… κ³ λ ¤
- λλ” JSDoc νƒ€μ… μ£Όμ„ μ¶”κ°€

### 10. API Rate Limiting
**μ„μΉ**: `routes/aps.js`

**κ¶μ¥**:
- APS API Rate Limit κ³ λ ¤
- μ”μ²­ μ ν• λ° μ¬μ‹λ„ λ΅μ§ μ¶”κ°€

### 11. ν™κ²½ λ³€μ κ²€μ¦
**μ„μΉ**: `server/config.js`

**κ¶μ¥**:
- μ„λ²„ μ‹μ‘ μ‹ ν•„μ ν™κ²½ λ³€μ κ²€μ¦
- λ…ν™•ν• μ—λ¬ λ©”μ‹μ§€

---

## β… μ κµ¬ν„λ λ¶€λ¶„

1. **2LO μΈμ¦ κµ¬ν„**: μ¬λ°”λ¥Έ OAuth 2.0 Client Credentials ν”λ΅μ°
2. **ν† ν° μΊμ‹±**: κΈ°λ³Έμ μΈ ν† ν° μΊμ‹± λ΅μ§ κµ¬ν„
3. **μ—λ¬ μ²λ¦¬**: try-catch λΈ”λ΅ μ‚¬μ©
4. **μ½”λ“ κµ¬μ΅°**: λΌμ°νΈ λ¶„λ¦¬ λ° μ„¤μ • νμΌ λ¶„λ¦¬
5. **λ΅κΉ…**: κΈ°λ³Έμ μΈ λ΅κΉ… μ‹μ¤ν… κµ¬ν„

---

## π“‹ μμ • μ°μ„ μμ„

### Phase 1 (μ¦‰μ‹ μμ •)
1. API μ—”λ“ν¬μΈνΈ μμ • (Top Folders)
2. JSON:API μ‘λ‹µ κµ¬μ΅° μ²λ¦¬ κ°μ„ 
3. ν΄λ” λ‚΄μ© μ΅°ν μ—”λ“ν¬μΈνΈ ν™•μΈ λ° μμ •

### Phase 2 (λ‹¨κΈ° κ°μ„ )
4. λ―Έμ‚¬μ© import μ κ±°
5. ν† ν° μΊμ‹± λ™μ‹μ„± μ²λ¦¬
6. μ—λ¬ μ‘λ‹µ κµ¬μ΅° ν‘μ¤€ν™”
7. API μ‘λ‹µ κ²€μ¦ μ¶”κ°€

### Phase 3 (μ¤‘κΈ° κ°μ„ )
8. λ΅κΉ… κ°μ„ 
9. νƒ€μ… μ•μ „μ„±
10. Rate Limiting
11. ν™κ²½ λ³€μ κ²€μ¦

---

## π“ μ°Έκ³  μλ£

- [APS Data Management API κ³µμ‹ λ¬Έμ„](https://aps.autodesk.com/en/docs/data/v2/developers_guide/overview/)
- [JSON:API μ¤ν™](https://jsonapi.org/)
- [OAuth 2.0 Client Credentials](https://oauth.net/2/grant-types/client-credentials/)

---

## λ¦¬λ·°μ–΄ μκ²¬

μ „λ°μ μΌλ΅ APS API ν†µν•©μ κΈ°λ³Έ κµ¬μ΅°λ” μ μ΅ν€μμµλ‹λ‹¤. λ‹¤λ§ APS Data Management APIμ JSON:API μ¤ν™ μ¤€μμ™€ μ—”λ“ν¬μΈνΈ μ •ν™•μ„±μ΄ κ°€μ¥ μ¤‘μ”ν• κ°μ„  μ‚¬ν•­μ…λ‹λ‹¤. νΉν ν΄λ” λ‚΄μ© μ΅°ν λ¶€λ¶„μ—μ„ 404 μ—λ¬κ°€ λ°μƒν•λ” κ²ƒμ€ μ—”λ“ν¬μΈνΈ λ¶μΌμΉλ‚ μ‘λ‹µ κµ¬μ΅° λ―Έμ²λ¦¬ λ•λ¬ΈμΌ κ°€λ¥μ„±μ΄ λ†’μµλ‹λ‹¤.

**μ¶”κ°€ κ¶μ¥μ‚¬ν•­**:
- APS κ³µμ‹ λ¬Έμ„μ μ—”λ“ν¬μΈνΈλ¥Ό μ§μ ‘ ν™•μΈν•μ—¬ μ •ν™•ν• URL μ‚¬μ©
- Postman λλ” μ μ‚¬ν• λ„κµ¬λ΅ API μ‘λ‹µ κµ¬μ΅° μ§μ ‘ ν™•μΈ
- λ‹¨μ„ ν…μ¤νΈ μ¶”κ°€ κ³ λ ¤

---

## β… μμ • μ™„λ£ μ‚¬ν•­

### Phase 1 (Critical Issues) - μ™„λ£
1. β… **API μ—”λ“ν¬μΈνΈ μμ •**
   - Top Folders: `/data/v1/projects/{projectId}/topFolders`λ΅ μμ •
   - ν΄λ” λ‚΄μ©: κΈ°λ³Έ μ—”λ“ν¬μΈνΈ μ‹¤ν¨ μ‹ relationships μ—”λ“ν¬μΈνΈ μλ™ μ‹λ„

2. β… **JSON:API μ‘λ‹µ κµ¬μ΅° μ²λ¦¬**
   - λ¨λ“  API μ‘λ‹µμ—μ„ `data`μ™€ `included` λ°°μ—΄ μ²λ¦¬
   - ν”„λ΅ νΈμ—”λ“μ—μ„ JSON:API κµ¬μ΅° μ§€μ›

3. β… **λ―Έμ‚¬μ© import μ κ±°**
   - `jwt` import μ κ±°

4. β… **ν† ν° μΊμ‹± λ™μ‹μ„± μ²λ¦¬**
   - `tokenPromise`λ¥Ό μ‚¬μ©ν• λ™μ‹ μ”μ²­ λ°©μ§€
   - Race condition ν•΄κ²°

5. β… **μ—λ¬ μ²λ¦¬ κ°μ„ **
   - λ¨λ“  λΌμ°νΈμ—μ„ μΌκ΄€λ μ—λ¬ μ‘λ‹µ κµ¬μ΅°
   - μƒμ„Έν• μ—λ¬ λ΅κΉ… μ¶”κ°€

6. β… **API μ‘λ‹µ κ²€μ¦**
   - `data.data`μ™€ `data.included` μ•μ „ν•κ² μ²λ¦¬
   - ν”„λ΅ νΈμ—”λ“μ—μ„ μ‘λ‹µ κµ¬μ΅° κ²€μ¦

---

## π“ μμ • ν›„ ν…μ¤νΈ μ²΄ν¬λ¦¬μ¤νΈ

- [ ] Hub λ©λ΅ μ΅°ν ν…μ¤νΈ
- [ ] Project λ©λ΅ μ΅°ν ν…μ¤νΈ
- [ ] Top Folders μ΅°ν ν…μ¤νΈ (μƒ μ—”λ“ν¬μΈνΈ)
- [ ] ν΄λ” λ‚΄μ© μ΅°ν ν…μ¤νΈ (κΈ°λ³Έ λ° relationships μ—”λ“ν¬μΈνΈ)
- [ ] νμΌ λ²„μ „ λ©λ΅ μ΅°ν ν…μ¤νΈ
- [ ] λ™μ‹ μ”μ²­ μ‹ ν† ν° μΊμ‹± ν…μ¤νΈ
- [ ] μ—λ¬ μ‘λ‹µ κµ¬μ΅° ν™•μΈ

---

## π”„ λ‹¤μ λ‹¨κ³„

1. **μ‹¤μ  APS ν™κ²½μ—μ„ ν…μ¤νΈ**
   - μ‹¤μ  Hub/Project/Folder λ°μ΄ν„°λ΅ ν…μ¤νΈ
   - λ‹¤μ–‘ν• μ‘λ‹µ κµ¬μ΅° ν™•μΈ

2. **μ„±λ¥ μµμ ν™”**
   - API μ‘λ‹µ μΊμ‹± κ³ λ ¤
   - λ¶ν•„μ”ν• API νΈμ¶ μµμ†ν™”

3. **μ‚¬μ©μ κ²½ν— κ°μ„ **
   - λ΅λ”© μƒνƒ ν‘μ‹ κ°μ„ 
   - μ—λ¬ λ©”μ‹μ§€ μ‚¬μ©μ μΉν™”μ μΌλ΅ κ°μ„ 

