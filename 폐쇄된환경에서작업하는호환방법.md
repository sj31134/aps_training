# 폐쇄된 환경에서 작업하는 호환 방법

이 문서는 **GitHub에 직접 접근할 수 없는 폐쇄된 환경의 Windows 작업자**를 위한 가이드입니다.

## 개요

### 작업 환경 구조

```
[Mac 개발자] ←→ [GitHub] ←→ [Windows 개발자 A]
                              ↓
                    [폐쇄된 환경 Windows 작업자]
                    (GitHub 직접 접근 불가)
```

### 작업 흐름

1. **파일 받기**: GitHub를 사용하는 작업자로부터 최신 파일 받기
2. **로컬 작업**: 폐쇄된 환경에서 파일 수정
3. **파일 전달**: 작업 완료 후 GitHub 사용 작업자에게 전달
4. **GitHub 동기화**: GitHub 사용 작업자가 변경사항을 GitHub에 반영

## 초기 환경 설정

### 1. Git 설치 (선택사항)

폐쇄된 환경에서도 Git을 설치하는 것을 권장합니다. Git이 없어도 작업 가능하지만, 호환성 검증에 유용합니다.

**설치 방법:**
- 다른 작업자로부터 Git 설치 파일 받기
- 또는 USB 등을 통해 설치 파일 전달받기
- 설치 후 Git Bash 또는 PowerShell에서 사용

**설치 확인:**
```powershell
git --version
```

### 2. Git 설정 (Git 설치한 경우)

Git을 설치했다면 다음 설정을 적용하세요:

```powershell
# 프로젝트 폴더로 이동
cd C:\Users\[사용자명]\Desktop\APS

# Git 설정
git config --local core.autocrlf true
git config --local pull.rebase false
git config --local core.filemode true
```

**설정 확인:**
```powershell
git config --local --list
```

### 3. Python 설치 확인

**Python이 설치되어 있지 않다면:**
- 다른 작업자로부터 Python 설치 파일 받기
- 또는 USB 등을 통해 설치 파일 전달받기
- [Python 공식 사이트](https://www.python.org/downloads/)에서 다운로드 (인터넷 접근 가능한 경우)
- 설치 시 "Add Python to PATH" 옵션 선택

**설치 확인:**
```powershell
python --version
# 또는
python3 --version
```

### 4. 프로젝트 폴더 구조 확인

받은 파일들이 다음 구조를 따르는지 확인하세요:

```
APS/
├── .gitignore
├── .git/                    # Git 저장소 정보 (있는 경우)
├── env.example
├── requirements.txt         # Python 패키지 의존성 (중요!)
├── APS_DEVELOPMENT.md
├── COMPATIBILITY_CHECK.md
├── VIRTUAL_ENV_GUIDE.md     # 가상환경 가이드
├── README.md
└── [기타 프로젝트 파일들]
```

**중요**: `requirements.txt` 파일이 반드시 포함되어 있어야 합니다. 이 파일로 동일한 Python 패키지를 설치합니다.

### 5. 가상환경 설정

**가상환경은 각 환경에서 독립적으로 생성합니다.** 받은 파일에 가상환경 폴더(`aps/`)가 포함되어 있지 않아도 정상입니다.

**가상환경 생성:**
```powershell
# 프로젝트 폴더로 이동
cd C:\Users\[사용자명]\Desktop\APS

# 가상환경 생성 (처음만)
python -m venv aps

# 가상환경 활성화
aps\Scripts\activate

# pip 업그레이드 (선택사항)
python -m pip install --upgrade pip

# 패키지 설치 (requirements.txt 사용)
pip install -r requirements.txt
```

**가상환경 활성화 확인:**
프롬프트에 `(aps)`가 표시되면 활성화된 것입니다:
```powershell
(aps) C:\Users\[사용자명]\Desktop\APS>
```

**작업 종료 시:**
```powershell
deactivate
```

자세한 내용은 `VIRTUAL_ENV_GUIDE.md`를 참고하세요.

## 파일 받는 방법

### 방법 1: GitHub 사용 작업자로부터 ZIP 파일 받기

**GitHub 사용 작업자가 해야 할 일:**
1. GitHub에서 최신 코드 다운로드
   - GitHub 저장소 페이지 → "Code" → "Download ZIP"
2. ZIP 파일을 폐쇄된 환경 작업자에게 전달
   - USB, 네트워크 공유 폴더, 보안 승인된 전송 방법 등

**폐쇄된 환경 작업자가 해야 할 일:**
1. ZIP 파일 받기
2. 작업 폴더에 압축 해제
   ```powershell
   # 예: C:\Users\[사용자명]\Desktop\APS
   Expand-Archive -Path "aps_training-main.zip" -DestinationPath "C:\Users\[사용자명]\Desktop\APS" -Force
   ```
3. 폴더 이름 확인 (보통 `aps_training-main` 또는 `APS`)
4. 필요시 폴더 이름 변경
   ```powershell
   Rename-Item -Path "aps_training-main" -NewName "APS"
   ```
5. **가상환경 생성** (받은 파일에 가상환경 폴더가 없어도 정상)
   ```powershell
   cd C:\Users\[사용자명]\Desktop\APS
   python -m venv aps
   aps\Scripts\activate
   pip install -r requirements.txt
   ```

### 방법 2: Git 저장소 전체 복사 (Git 설치한 경우)

**GitHub 사용 작업자가 해야 할 일:**
1. 로컬 Git 저장소 전체 폴더를 ZIP으로 압축
   - `.git` 폴더 포함하여 압축
2. ZIP 파일 전달

**폐쇄된 환경 작업자가 해야 할 일:**
1. ZIP 파일 받기
2. 압축 해제
3. Git 저장소로 인식되는지 확인
   ```powershell
   cd C:\Users\[사용자명]\Desktop\APS
   git status
   ```
4. **가상환경 생성** (받은 파일에 가상환경 폴더가 없어도 정상)
   ```powershell
   python -m venv aps
   aps\Scripts\activate
   pip install -r requirements.txt
   ```

### 방법 3: 특정 파일만 받기 (부분 업데이트)

**GitHub 사용 작업자가 해야 할 일:**
1. 변경된 파일만 목록 작성
2. 해당 파일들만 전달

**폐쇄된 환경 작업자가 해야 할 일:**
1. 받은 파일들을 기존 프로젝트 폴더에 덮어쓰기
2. 파일 경로 확인

## 작업 시 주의사항

### 1. 줄바꿈 문자 유지

**중요**: 파일을 편집할 때 줄바꿈 문자가 변경되지 않도록 주의하세요.

**권장 에디터 설정:**
- **VS Code**: 
  - 하단 상태바에서 "CRLF" 또는 "LF" 확인
  - Windows에서는 "CRLF" 유지
  - 설정: `"files.eol": "\r\n"` (Windows)
  
- **Notepad++**:
  - Edit → EOL Conversion → Windows Format (CRLF)
  
- **일반 텍스트 에디터**:
  - Windows 기본 메모장은 CRLF 사용 (안전)

**확인 방법:**
```powershell
# PowerShell에서 줄바꿈 문자 확인
Get-Content README.md -Raw | Select-String -Pattern "`r`n" | Measure-Object
```

### 2. 파일 인코딩

- **UTF-8 인코딩 사용** (BOM 없음 권장)
- 한글 등 멀티바이트 문자가 포함된 경우 UTF-8 필수

**VS Code 설정:**
```json
{
  "files.encoding": "utf8"
}
```

### 3. 파일 경로

- **절대 경로 사용 금지**: 프로젝트 내 상대 경로만 사용
- **Windows 경로 구분자**: 백슬래시(`\`) 대신 슬래시(`/`) 또는 `path.join()` 사용

**❌ 잘못된 예:**
```javascript
const filePath = 'C:\\Users\\...\\file.txt';
```

**✅ 올바른 예:**
```javascript
const path = require('path');
const filePath = path.join(__dirname, 'relative', 'path', 'file.txt');
```

### 4. 환경 변수 파일

- **`.env` 파일은 절대 전달하지 마세요**
- `env.example` 파일만 참고하여 로컬에서 `.env` 생성
- `.env` 파일은 `.gitignore`에 포함되어 있음

### 5. 가상환경 관리

**중요**: 가상환경 폴더(`aps/`)는 절대 전달하지 마세요.

- **가상환경은 각 환경에서 독립적으로 생성**
- 받은 파일에 `requirements.txt`가 있으면 그것으로 패키지 설치
- 가상환경 폴더는 `.gitignore`에 포함되어 Git에 커밋되지 않음

**패키지 추가/변경 시:**
```powershell
# 1. 가상환경 활성화
aps\Scripts\activate

# 2. 패키지 설치
pip install 새패키지명

# 3. requirements.txt 업데이트
pip freeze > requirements.txt

# 4. requirements.txt만 전달 (가상환경 폴더는 제외)
```

### 6. 대용량 파일

- **Revit 파일 (`.rvt`, `.rfa`)**: 용량이 크므로 Git에 포함되지 않음
- **가상환경 폴더 (`aps/`)**: 용량이 크고 플랫폼별로 다르므로 전달하지 않음
- 필요시 별도로 전달받아야 함
- 프로젝트 폴더 외부에 보관 권장

## 작업 후 파일 전달 방법

### 방법 1: 변경된 파일만 전달

**작업 전 준비:**
1. 받은 파일의 타임스탬프 또는 해시 값 기록
   ```powershell
   # 파일 목록과 수정 시간 기록
   Get-ChildItem -Recurse -File | Select-Object FullName, LastWriteTime | Export-Csv -Path "파일목록_받은시점.csv"
   ```

**작업 후:**
1. 변경된 파일 확인
   ```powershell
   # 수정된 파일 찾기
   Get-ChildItem -Recurse -File | Where-Object { $_.LastWriteTime -gt (Get-Date).AddDays(-1) } | Select-Object FullName
   ```
2. 변경된 파일만 ZIP으로 압축
   ```powershell
   # 변경된 파일만 압축
   $changedFiles = Get-ChildItem -Recurse -File | Where-Object { $_.LastWriteTime -gt (Get-Date).AddDays(-1) }
   Compress-Archive -Path $changedFiles.FullName -DestinationPath "변경된파일.zip"
   ```
3. 변경 내역 문서 작성 (선택사항)
   - 어떤 파일을 수정했는지
   - 어떤 내용을 변경했는지
   - 변경 이유

### 방법 2: 전체 프로젝트 폴더 전달

**작업 후:**
1. 전체 프로젝트 폴더를 ZIP으로 압축
   ```powershell
   # 상위 폴더에서 압축 (폴더명 포함)
   Compress-Archive -Path "APS" -DestinationPath "APS_작업완료_날짜.zip"
   ```
2. **제외할 파일/폴더 확인:**
   - `.env` 파일 (환경 변수)
   - `aps/` 폴더 (가상환경, 각 환경에서 재생성)
   - `venv/`, `env/` 등 다른 가상환경 폴더
   - `node_modules/` (의존성, 재설치 가능)
   - `.git/` (Git 저장소 정보, 선택사항)
   - `__pycache__/`, `*.pyc` (Python 캐시)
   - 임시 파일, 빌드 출력 등

**압축 전 정리 스크립트 예시:**
```powershell
# 불필요한 파일 삭제
Remove-Item -Path "aps" -Recurse -Force -ErrorAction SilentlyContinue
Remove-Item -Path "venv" -Recurse -Force -ErrorAction SilentlyContinue
Remove-Item -Path "env" -Recurse -Force -ErrorAction SilentlyContinue
Remove-Item -Path "node_modules" -Recurse -Force -ErrorAction SilentlyContinue
Remove-Item -Path ".env" -Force -ErrorAction SilentlyContinue
Remove-Item -Path "*.log" -Force -ErrorAction SilentlyContinue
Get-ChildItem -Path . -Recurse -Filter "__pycache__" | Remove-Item -Recurse -Force -ErrorAction SilentlyContinue
Get-ChildItem -Path . -Recurse -Filter "*.pyc" | Remove-Item -Force -ErrorAction SilentlyContinue

# 압축
Compress-Archive -Path "APS" -DestinationPath "APS_작업완료_$(Get-Date -Format 'yyyyMMdd').zip"
```

**중요**: `requirements.txt` 파일은 반드시 포함해야 합니다!

### 방법 3: Git Patch 파일 생성 (Git 설치한 경우)

**작업 전:**
```powershell
# 받은 시점의 상태 저장
git add -A
git commit -m "받은 시점 상태" --allow-empty
```

**작업 후:**
```powershell
# 변경사항을 패치 파일로 생성
git diff HEAD~1 > 변경사항.patch

# 또는 특정 파일만
git diff HEAD~1 -- 파일명 > 변경사항_파일명.patch
```

**GitHub 사용 작업자가 적용:**
```bash
# 패치 파일 적용
git apply 변경사항.patch
```

## GitHub 사용 작업자가 해야 할 일

### 파일 받은 후

1. **백업 생성**
   ```bash
   # 현재 작업 내용 백업
   git stash
   # 또는
   git commit -m "작업 중 백업"
   ```

2. **받은 파일 확인**
   - 어떤 파일이 변경되었는지 확인
   - 변경 내역 문서 확인 (있는 경우)

3. **파일 적용**
   ```bash
   # 방법 1: ZIP 파일 압축 해제 후 덮어쓰기
   # 방법 2: 변경된 파일만 복사
   # 방법 3: Git patch 적용 (patch 파일인 경우)
   git apply 변경사항.patch
   ```

4. **호환성 검증**
   ```bash
   # 줄바꿈 문자 확인
   git diff --check
   
   # 파일 상태 확인
   git status
   
   # 변경사항 확인
   git diff
   ```

5. **커밋 및 푸시**
   ```bash
   git add .
   git commit -m "폐쇄된 환경 작업자로부터 받은 변경사항"
   git push origin master
   ```

## 작업 워크플로우 예시

### 시나리오 1: 새 기능 개발

1. **폐쇄된 환경 작업자**
   - GitHub 사용 작업자로부터 최신 코드 받기
   - 새 기능 개발
   - 변경된 파일만 전달

2. **GitHub 사용 작업자**
   - 변경사항 받기
   - 로컬에서 테스트
   - GitHub에 커밋 및 푸시

3. **다른 작업자들**
   - GitHub에서 최신 코드 pull

### 시나리오 2: 버그 수정

1. **폐쇄된 환경 작업자**
   - 특정 버그 수정
   - 수정한 파일과 변경 내역 문서 전달

2. **GitHub 사용 작업자**
   - 변경사항 확인 및 적용
   - 테스트 후 GitHub에 반영

### 시나리오 3: 문서 업데이트

1. **폐쇄된 환경 작업자**
   - 문서 파일 수정
   - 수정된 문서 파일 전달

2. **GitHub 사용 작업자**
   - 문서 파일 교체
   - GitHub에 커밋

## 호환성 체크리스트

### 파일 받기 전
- [ ] 받을 파일의 출처 확인 (GitHub 사용 작업자)
- [ ] 받을 파일의 버전/날짜 확인
- [ ] 작업 폴더 준비

### 파일 받은 후
- [ ] 파일 구조 확인
- [ ] 필수 파일 존재 확인 (`.gitignore`, `README.md`, `requirements.txt` 등)
- [ ] `requirements.txt` 파일 확인 (Python 패키지 의존성)
- [ ] 가상환경 생성 및 패키지 설치
  ```powershell
  python -m venv aps
  aps\Scripts\activate
  pip install -r requirements.txt
  ```
- [ ] 파일 인코딩 확인 (UTF-8)
- [ ] 줄바꿈 문자 확인 (Windows: CRLF)

### 작업 중
- [ ] 줄바꿈 문자 유지 (CRLF)
- [ ] 파일 인코딩 유지 (UTF-8)
- [ ] 절대 경로 사용하지 않기
- [ ] `.env` 파일 수정하지 않기 (로컬에서만 사용)

### 작업 완료 후
- [ ] 변경된 파일 목록 작성
- [ ] 변경 내역 문서 작성 (선택사항)
- [ ] `requirements.txt` 업데이트 (패키지 추가/변경한 경우)
  ```powershell
  aps\Scripts\activate
  pip freeze > requirements.txt
  ```
- [ ] 불필요한 파일 제거 (`.env`, `aps/`, `node_modules` 등)
- [ ] ZIP 파일 생성 또는 변경 파일만 정리
- [ ] `requirements.txt` 포함 확인 (변경된 경우)

### 전달 전
- [ ] 전달할 파일 목록 확인
- [ ] 변경 내역 문서 포함 (있는 경우)
- [ ] 파일 크기 확인 (대용량 파일 별도 처리)

## 문제 해결

### 문제 1: 줄바꿈 문자 변경됨

**증상**: 파일이 수정되지 않았는데 변경으로 표시됨

**해결:**
```powershell
# Git이 있다면
git config --local core.autocrlf true
git add --renormalize .
```

**예방:**
- 에디터에서 줄바꿈 문자 설정 확인
- Windows에서는 CRLF 유지

### 문제 2: 파일 인코딩 문제

**증상**: 한글이 깨져서 표시됨

**해결:**
- 파일을 UTF-8 (BOM 없음)로 저장
- VS Code에서 인코딩 변경: 하단 상태바 클릭 → "Save with Encoding" → "UTF-8"

### 문제 3: 파일 경로 문제

**증상**: 코드에서 파일을 찾을 수 없음

**해결:**
- 절대 경로 대신 상대 경로 사용
- `path.join()` 또는 `path.resolve()` 사용

### 문제 4: 가상환경 관련 오류

**증상**: Python 패키지를 찾을 수 없음, 모듈을 import할 수 없음

**해결:**
```powershell
# 1. 가상환경이 활성화되어 있는지 확인
# 프롬프트에 (aps)가 표시되어야 함

# 2. 가상환경 재생성
deactivate
Remove-Item -Recurse -Force aps
python -m venv aps
aps\Scripts\activate
pip install -r requirements.txt
```

**예방:**
- 작업 시작 시 항상 가상환경 활성화
- `requirements.txt` 변경 시 업데이트 후 전달

### 문제 5: 대용량 파일 전달

**증상**: ZIP 파일이 너무 큼

**해결:**
- 변경된 파일만 전달
- 가상환경 폴더(`aps/`)는 제외 (각 환경에서 재생성)
- 대용량 파일은 별도로 전달
- 압축 전 불필요한 파일 제거

## 보안 고려사항

### 전달 시
- [ ] 민감한 정보가 포함된 파일 제외 (`.env`, 비밀키 등)
- [ ] 가상환경 폴더(`aps/`) 제외 확인
- [ ] `requirements.txt` 포함 확인 (변경된 경우)
- [ ] 전달 방법의 보안 확인 (승인된 채널 사용)
- [ ] 파일 무결성 확인 (해시 값 비교, 선택사항)

### 받은 후
- [ ] 파일 출처 확인
- [ ] 바이러스 검사 (필요시)
- [ ] 받은 파일의 무결성 확인 (해시 값 비교, 선택사항)

## 요약

### 핵심 원칙

1. **줄바꿈 문자 유지**: Windows CRLF (`\r\n`)
2. **인코딩 유지**: UTF-8 (BOM 없음)
3. **경로 독립성**: 절대 경로 사용 금지
4. **환경 변수 분리**: `.env` 파일은 전달하지 않음
5. **가상환경 분리**: `aps/` 폴더는 전달하지 않음, `requirements.txt`로 공유
6. **변경 내역 문서화**: 무엇을 변경했는지 기록

### 작업 흐름

```
[GitHub 사용 작업자] 
    ↓ (최신 코드 전달, requirements.txt 포함, aps/ 폴더 제외)
[폐쇄된 환경 작업자]
    ↓ (로컬에서 가상환경 생성: python -m venv aps)
    ↓ (패키지 설치: pip install -r requirements.txt)
    ↓ (작업)
[폐쇄된 환경 작업자]
    ↓ (변경사항 전달, requirements.txt 포함, aps/ 폴더 제외)
[GitHub 사용 작업자]
    ↓ (가상환경에서 테스트)
    ↓ (GitHub에 반영)
[GitHub]
    ↓ (다른 작업자들이 pull)
[다른 작업자들]
    ↓ (각자 가상환경에서 pip install -r requirements.txt)
```

이 가이드를 따르면 폐쇄된 환경에서도 기존 Mac-Windows-GitHub 환경과 호환되게 작업할 수 있습니다.

## 가상환경 관련 추가 참고

- **가상환경 상세 가이드**: [VIRTUAL_ENV_GUIDE.md](./VIRTUAL_ENV_GUIDE.md) 참고
- **핵심 원칙**: 가상환경은 각 환경에서 독립적으로 생성하고, `requirements.txt`로 동일한 패키지를 설치합니다.

